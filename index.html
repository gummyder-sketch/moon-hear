<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MOON HEAR — Stream Jin</title>
  <meta name="description" content="MOON HEAR is a calm space to stream Jin’s official discography and view personal Last.fm listening stats." />

  <style>
    :root{
      --bg:#0b0b10;
      --card:#11111a;
      --muted:#a8a8b3;
      --text:#f2f2f6;
      --line:#242433;
      --accent:#cbb7ff;
      --accent2:#8bd3ff;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --r:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(203,183,255,.12), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(139,211,255,.10), transparent 60%),
        var(--bg);
      color:var(--text);
    }
    a{color:inherit}
    .wrap{max-width:1100px; margin:0 auto; padding:22px 18px 70px;}

    /* Header: no sticky (avoids overlay bugs), still looks premium */
    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      background: rgba(11,11,16,.55);
      border:1px solid rgba(36,36,51,.6);
      border-radius: 16px;
      padding:14px 16px;
      margin-bottom:18px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.4px}
    .dot{width:10px; height:10px; border-radius:999px; background:linear-gradient(135deg,var(--accent),var(--accent2)); box-shadow:0 0 0 6px rgba(203,183,255,.08)}
    .nav{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .pill{
      padding:9px 12px;
      border:1px solid rgba(36,36,51,.8);
      border-radius:999px;
      background:rgba(17,17,26,.55);
      font-size:14px;
      color:var(--muted);
      text-decoration:none;
      user-select:none;
    }
    .pill:hover{border-color:rgba(203,183,255,.5); color:var(--text)}

    .hero{
      display:grid; grid-template-columns: 1.3fr .7fr; gap:16px; align-items:stretch;
      margin-top:10px;
    }
    @media (max-width: 860px){ .hero{grid-template-columns:1fr} }

    .card{
      background:linear-gradient(180deg, rgba(17,17,26,.75), rgba(17,17,26,.55));
      border:1px solid rgba(36,36,51,.8);
      border-radius:var(--r);
      box-shadow:var(--shadow);
      padding:18px;
    }

    h1{margin:0 0 8px; font-size:44px; line-height:1.05}
    .sub{color:var(--muted); font-size:16px; line-height:1.6; max-width:62ch}
    .cta{display:flex; gap:10px; flex-wrap:wrap; margin-top:16px}

    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:11px 14px;
      border-radius:12px;
      border:1px solid rgba(36,36,51,.9);
      background:rgba(255,255,255,.02);
      text-decoration:none;
      font-weight:600;
      color:var(--text);
      cursor:pointer;
    }
    .btn:hover{border-color:rgba(203,183,255,.55)}
    .btn.primary{
      background:linear-gradient(135deg, rgba(203,183,255,.22), rgba(139,211,255,.18));
      border-color:rgba(203,183,255,.55);
    }
    .small{font-size:13px; color:var(--muted)}
    .kpi{display:flex; flex-direction:column; gap:6px}
    .kpi b{font-size:22px}
    .kpi span{color:var(--muted); font-size:13px}

    .section{margin-top:16px}
    .section h2{margin:0 0 8px; font-size:18px; letter-spacing:.2px}
    .hr{height:1px; background:rgba(36,36,51,.8); margin:16px 0}

    .grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; margin-top:16px;}
    @media (max-width: 900px){ .grid{grid-template-columns:1fr} }

    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width: 700px){ .row{grid-template-columns:1fr} }

    label{display:block; margin-bottom:6px}
    input{
      width:100%;
      padding:11px 12px;
      border-radius:12px;
      border:1px solid rgba(36,36,51,.9);
      background:rgba(0,0,0,.2);
      color:var(--text);
      outline:none;
    }
    input:focus{border-color:rgba(203,183,255,.55)}
    ul{margin:10px 0 0; padding-left:18px}

    .ok{color: #bfe8c5}
    .warn{color: #ffd6a6}

    footer{margin-top:22px; color:var(--muted); font-size:12px; line-height:1.6}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand"><span class="dot"></span> MOON HEAR</div>
      <nav class="nav">
        <a class="pill" href="#discography">Discography</a>
        <a class="pill" href="#stats">My Listening</a>
        <a class="pill" href="#counter">Stream Counter</a>
        <a class="pill" href="#guide">Stream Guide</a>
        <a class="pill" href="#translate">Translate</a>
      </nav>
    </header>

    <section class="hero">
      <div class="card">
        <h1>Stream Jin.<br>Quietly, with purpose.</h1>
        <p class="sub">
          MOON HEAR is a calm, no-pressure space for streaming Jin’s official discography and viewing your personal listening stats via Last.fm.
          If you can stream today, that’s enough.
        </p>
        <div class="cta">
          <a class="btn primary" href="#discography">Start streaming</a>
          <a class="btn" href="#stats">Connect Last.fm</a>
          <a class="btn" href="#counter">I streamed today</a>
        </div>
        <p class="small" style="margin-top:12px">
          Want this page in your language? Use your browser’s translate feature.
        </p>
      </div>

      <div class="card">
        <div class="kpi">
          <span>Today’s reminder</span>
          <b>You don’t need to do more than you can.</b>
          <span>Support is not a competition.</span>
        </div>
        <div class="hr"></div>
        <div class="kpi">
          <span>Stats sources</span>
          <b>Last.fm</b>
          <span>Stats.fm is supported via profile links only.</span>
        </div>
      </div>
    </section>

    <section id="discography" class="section card">
      <h2>Discography</h2>
      <p class="small">We’ll fill this with official links (Spotify / YouTube / Apple Music). Keeping it clean and easy.</p>
      <div class="grid">
        <div class="card" style="box-shadow:none">
          <b>Album / Single</b><br><span class="small">Official listen buttons</span>
        </div>
        <div class="card" style="box-shadow:none">
          <b>OST / Collaboration</b><br><span class="small">Official videos & tracks</span>
        </div>
        <div class="card" style="box-shadow:none">
          <b>Playlist</b><br><span class="small">A calm stream mix</span>
        </div>
      </div>
    </section>

    <section id="stats" class="section card">
      <h2>My Listening (Last.fm)</h2>
      <p class="small">
        Enter your Last.fm username. MOON HEAR reads public scrobble data and shows your Jin listening stats.
      </p>

      <div class="row" style="margin-top:10px">
        <div>
          <label class="small" for="lfmUser">Last.fm username</label>
          <input id="lfmUser" autocomplete="off" spellcheck="false" placeholder="e.g., moonhear_user" />
        </div>
        <div>
          <label class="small" for="statsfmUrl">Stats.fm profile link (optional)</label>
          <input id="statsfmUrl" autocomplete="off" spellcheck="false" placeholder="paste your Stats.fm profile URL" />
        </div>
      </div>

      <div class="cta" style="margin-top:12px">
        <button class="btn primary" type="button" id="btnStats">Show my Jin stats</button>
        <button class="btn" type="button" id="btnStatsFm">Open Stats.fm profile</button>
      </div>

      <div class="row" style="margin-top:12px">
        <div class="card" style="box-shadow:none">
          <div class="kpi">
            <span>Jin scrobbles (7 days)</span>
            <b id="jin7">—</b>
            <span class="small">From your Last.fm top artists.</span>
          </div>
        </div>
        <div class="card" style="box-shadow:none">
          <div class="kpi">
            <span>Jin scrobbles (30 days)</span>
            <b id="jin30">—</b>
            <span class="small">From your Last.fm top artists.</span>
          </div>
        </div>
      </div>

      <div class="card" style="box-shadow:none; margin-top:12px">
        <div class="kpi">
          <span>Your top Jin track (7 days)</span>
          <b id="topJinTrack">—</b>
          <span class="small" id="topJinTrackPlays"></span>
        </div>
      </div>

      <p class="small warn" id="statsNote" style="margin-top:10px">
        Note: If you see 0, your Last.fm may store the artist name differently (e.g., JIN / Jin (BTS)). We can adjust one line.
      </p>
    </section>

    <section id="counter" class="section card">
      <h2>Stream Counter</h2>
      <p class="small">This counter reflects intention, not algorithms. Click once when you stream Jin today.</p>

      <div class="row" style="margin-top:10px">
        <div class="card" style="box-shadow:none">
          <div class="kpi">
            <span>Global support clicks</span>
            <b id="globalCount">Coming soon</b>
            <span class="small">Next step: free global counter database.</span>
          </div>
        </div>
        <div class="card" style="box-shadow:none">
          <div class="kpi">
            <span>Your clicks on this device</span>
            <b id="localCount">0</b>
            <span class="small">Stored only in your browser.</span>
          </div>
        </div>
      </div>

      <div class="cta" style="margin-top:12px">
        <button class="btn primary" type="button" id="btnLocalAdd">I streamed today</button>
        <button class="btn" type="button" id="btnLocalReset">Reset (only you)</button>
      </div>
    </section>

    <section id="guide" class="section card">
      <h2>Stream Guide (calm + respectful)</h2>
      <div class="row" style="margin-top:10px">
        <div class="card" style="box-shadow:none">
          <b>Do</b>
          <ul class="small">
            <li>Use official links and playlists.</li>
            <li>Keep volume audible (not muted).</li>
            <li>Mix tracks naturally—no pressure.</li>
          </ul>
        </div>
        <div class="card" style="box-shadow:none">
          <b>Avoid</b>
          <ul class="small">
            <li>Looping a single track endlessly.</li>
            <li>Spam clicking or bot behavior.</li>
            <li>Turning support into competition.</li>
          </ul>
        </div>
      </div>
      <p class="small" style="margin-top:10px">
        Support should feel safe. If you’re tired, take a break. You’re still part of this.
      </p>
    </section>

    <section id="translate" class="section card">
      <h2>Translate</h2>
      <p class="small">
        MOON HEAR is written in English. To read it in your language, use your browser’s built-in translate feature
        (Chrome: right click → Translate).
      </p>
    </section>

    <footer>
      <div class="hr"></div>
      MOON HEAR is a fan-made hub for linking to official platforms. No audio is hosted here.
      Last.fm data is displayed from public scrobbles. This site is not affiliated with Jin, BTS, Last.fm, or Stats.fm.
    </footer>
  </div>

  <script>
    // ===== Config =====
    const LASTFM_API_KEY = "4ae50120922de69f204dcb69ac15180f";
    const TARGET_ARTIST = "Jin"; // change to "JIN" or "Jin (BTS)" if needed

    // ===== Local counter =====
    const LOCAL_KEY = "moonhear_local_count_v1";
    function getLocal(){ return parseInt(localStorage.getItem(LOCAL_KEY) || "0", 10); }
    function setLocal(n){
      localStorage.setItem(LOCAL_KEY, String(n));
      document.getElementById("localCount").textContent = String(n);
    }
    setLocal(getLocal());

    // ===== Stats.fm link =====
    function openStatsFm(){
      const url = document.getElementById("statsfmUrl").value.trim();
      if(!url){ alert("Paste your Stats.fm profile URL first."); return; }
      window.open(url, "_blank", "noopener,noreferrer");
    }

    // ===== Last.fm JSONP (works on GitHub Pages) =====
    function jsonp(url){
      return new Promise((resolve, reject) => {
        const cb = "mh_cb_" + Math.random().toString(36).slice(2);
        window[cb] = (data) => { cleanup(); resolve(data); };
        const script = document.createElement("script");
        script.src = url + "&callback=" + cb;
        script.onerror = () => { cleanup(); reject(new Error("JSONP failed")); };
        document.body.appendChild(script);
        function cleanup(){
          try { delete window[cb]; } catch(e){ window[cb] = undefined; }
          if(script.parentNode) script.parentNode.removeChild(script);
        }
      });
    }

    function lfmUrl(method, params){
      const base = "https://ws.audioscrobbler.com/2.0/?format=json";
      const q = new URLSearchParams({ method, api_key: LASTFM_API_KEY, ...params });
      return base + "&" + q.toString();
    }

    function norm(s){ return (s || "").trim().toLowerCase(); }

    function findArtistPlaycount(topArtists, artistName){
      const items = topArtists?.topartists?.artist || [];
      const target = norm(artistName);
      const hit = items.find(a => norm(a.name) === target);
      return hit ? parseInt(hit.playcount || "0", 10) : 0;
    }

    function findTopTrackForArtist(topTracks, artistName){
      const items = topTracks?.toptracks?.track || [];
      const target = norm(artistName);
      const hit = items.find(t => norm(t.artist?.name) === target);
      if(!hit) return null;
      return { name: hit.name, plays: parseInt(hit.playcount || "0", 10) };
    }

    async function showJinStats(){
      const user = document.getElementById("lfmUser").value.trim();
      if(!user){ alert("Please enter your Last.fm username."); return; }

      document.getElementById("jin7").textContent = "Loading…";
      document.getElementById("jin30").textContent = "Loading…";
      document.getElementById("topJinTrack").textContent = "Loading…";
      document.getElementById("topJinTrackPlays").textContent = "";

      try{
        const topArtists7 = await jsonp(lfmUrl("user.gettopartists", { user, period:"7day", limit:"200" }));
        const topTracks7  = await jsonp(lfmUrl("user.gettoptracks",  { user, period:"7day", limit:"200" }));

        const jin7 = findArtistPlaycount(topArtists7, TARGET_ARTIST);
        document.getElementById("jin7").textContent = String(jin7);

        const topJinTrack = findTopTrackForArtist(topTracks7, TARGET_ARTIST);
        if(topJinTrack){
          document.getElementById("topJinTrack").textContent = topJinTrack.name;
          document.getElementById("topJinTrackPlays").textContent = `${topJinTrack.plays} plays (7 days)`;
        } else {
          document.getElementById("topJinTrack").textContent = "No Jin track found (7 days)";
        }

        const topArtists30 = await jsonp(lfmUrl("user.gettopartists", { user, period:"1month", limit:"200" }));
        const jin30 = findArtistPlaycount(topArtists30, TARGET_ARTIST);
        document.getElementById("jin30").textContent = String(jin30);

      } catch(e){
        console.error(e);
        alert("Could not load Last.fm stats. Check your username and try again.");
        document.getElementById("jin7").textContent = "—";
        document.getElementById("jin30").textContent = "—";
        document.getElementById("topJinTrack").textContent = "—";
        document.getElementById("topJinTrackPlays").textContent = "";
      }
    }

    // ===== Wire buttons (no inline onclick = fewer mistakes) =====
    document.getElementById("btnStats").addEventListener("click", showJinStats);
    document.getElementById("btnStatsFm").addEventListener("click", openStatsFm);
    document.getElementById("btnLocalAdd").addEventListener("click", () => setLocal(getLocal() + 1));
    document.getElementById("btnLocalReset").addEventListener("click", () => setLocal(0));
  </script>
</body>
</html>
